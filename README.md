# ğŸ­ AI í† ë¡  ë°°í‹€

ì„œë¡œ ë‹¤ë¥¸ ì„±ê²©ì˜ AI 3ì¸ì´ ììœ¨ í† ë¡ í•˜ëŠ” ê´€ì „í˜• ì—”í„°í…Œì¸ë¨¼íŠ¸ í”Œë«í¼

## ê°œìš”

8ëª…ì˜ AI í˜ë¥´ì†Œë‚˜ ì¤‘ ëœë¤ 3ëª…ì´ ì„ ë°œë˜ì–´ ì£¼ì–´ì§„ ì£¼ì œì— ëŒ€í•´ ììœ¨ì ìœ¼ë¡œ í† ë¡ í•˜ê³ ,
ì‚¬ìš©ìëŠ” ì´ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê´€ì „Â·íˆ¬í‘œí•˜ëŠ” ì—”í„°í…Œì¸ë¨¼íŠ¸ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

## í•µì‹¬ ì»¨ì…‰

- **ëœë¤ ìºìŠ¤íŒ…** â€” ë§¤ í† ë¡ ë§ˆë‹¤ 8ëª… ì¤‘ 3ëª…ì´ ëœë¤ ì„ ë°œ, ì…ì¥ ì•Œë¦¼ìœ¼ë¡œ ë°œí‘œ
- **ììœ¨ í† ë¡ ** â€” AI 3ì¸ì´ ì‚¬ìš©ì ê°œì… ì—†ì´ ë…ë¦½ì ìœ¼ë¡œ ë…¼ìŸì„ ì „ê°œ
- **ê´€ì „ ê²½í—˜** â€” ì‚¬ìš©ìëŠ” í† ë¡ ì„ ì§€ì¼œë³´ë©° íˆ¬í‘œë¡œ ìŠ¹ìë¥¼ ê²°ì •
- **ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°** â€” Gemini API ìŠ¤íŠ¸ë¦¬ë° + íƒ€ì´í•‘ ì• ë‹ˆë©”ì´ì…˜

## í˜ë¥´ì†Œë‚˜ í’€ (8ëª…)

| í‚¤ | ì´ë¦„ | ì§í•¨ | ì„¤ëª… |
|----|------|------|------|
| A | ìì¹­ ë…¼ë¦¬ì™• | ëƒ‰ì² í•œ ë¶„ì„ê°€ | ë°ì´í„°ì™€ ë…¼ë¦¬ë¡œë§Œ ë§í•œë‹¤ |
| B | ë‚˜..ì•ˆìš´ë‹¤ | ë”°ëœ»í•œ ê³µê°ëŸ¬ | ì‚¬ëŒì˜ ê°ì •ê³¼ ê´€ê³„ë¥¼ ìµœìš°ì„  |
| C | ì…ë§Œì‚´ì•˜ìŒ | ì§ì„¤ì  ë°˜ê³¨ | ëª¨ë“  ê²ƒì— ë°˜ë°•, ë¶ˆí¸í•œ ì§„ì‹¤ |
| D | ì¹´ë”ë¼í†µì‹  | ë£¨ë¨¸ ì „ë¬¸ê°€ | ì˜¨ê°– ì°ê³¼ ì¹´ë”ë¼ë¡œ ë¬´ì¥ |
| E | í˜„ìƒì‚´ê¸°ë°”ë¹  | í˜„ì‹¤ì£¼ì˜ì | ì´ìƒë¡ ì€ ì‚¬ì ˆ, ì‹¤ìš©ì ì¸ ê²ƒë§Œ |
| F | ê³µëŒ€ê°ì„± | íš¨ìœ¨ ì§‘ì°©ì | ë­ë“  ìˆ˜ì¹˜í™”í•˜ê³  ë¹„íš¨ìœ¨ ëª» ì°¸ìŒ |
| G | ì² í•™í•˜ëŠ”ê³° | ë³¸ì§ˆ íƒêµ¬ì | ëª¨ë“  ê²ƒì˜ ê·¼ë³¸ì„ íŒŒê³ ë“¦ |
| H | ì¸í„°ë„·ê³ ì¸ë¬¼ | ì‹œë‹ˆì»¬í•œ ê³ ì¸ë¬¼ | ë‹¤ ì•Œê³  ìˆë‹¤, ë‹¤ ë³¸ ê±°ë‹¤ |

## ê¸°ìˆ  ìŠ¤íƒ

**Frontend**
- Next.js (App Router) + React + TypeScript
- Tailwind CSS â€” ìŠ¤íƒ€ì¼ë§
- Framer Motion â€” ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜, íƒ€ì´í•‘ ì»¤ì„œ

**Backend**
- Next.js API Routes
- Google Gemini API â€” í˜ë¥´ì†Œë‚˜ ë°œì–¸ ìƒì„± (ìŠ¤íŠ¸ë¦¬ë°)
- Prisma ORM + MySQL

**ì¸í”„ë¼**
- GitHub Actions â€” ìë™ ë°°í¬ (lint â†’ build â†’ pm2 reload)
- PM2 â€” í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ (í¬íŠ¸ 3020)
- ì„œë¹„ìŠ¤ URL: https://persona.neurondev.co.kr

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
app/
â”œâ”€â”€ page.tsx                     # ë©”ì¸ (ì£¼ì œ ì…ë ¥, í„´ ìˆ˜ ì„ íƒ, ì…ì¥ ì•Œë¦¼)
â”œâ”€â”€ layout.tsx                   # ê³µí†µ ë ˆì´ì•„ì›ƒ + ë©”íƒ€ë°ì´í„°
â”œâ”€â”€ api/debate/
â”‚   â”œâ”€â”€ start/route.ts           # POST â€” í† ë¡  ìƒì„±, ëœë¤ 3ì¸ ì„ ë°œ
â”‚   â””â”€â”€ [id]/
â”‚       â”œâ”€â”€ route.ts             # GET  â€” í† ë¡  + ë©”ì‹œì§€ ì¡°íšŒ (personas í¬í•¨)
â”‚       â”œâ”€â”€ next/route.ts        # POST â€” ë‹¤ìŒ í„´ Gemini ìŠ¤íŠ¸ë¦¬ë° í˜¸ì¶œ
â”‚       â”œâ”€â”€ vote/route.ts        # POST â€” IP ê¸°ë°˜ íˆ¬í‘œ
â”‚       â””â”€â”€ summary/route.ts     # GET  â€” Gemini í† ë¡  ìš”ì•½ ìƒì„±
â””â”€â”€ debate/[id]/
    â”œâ”€â”€ page.tsx                 # ê´€ì „ í˜ì´ì§€
    â”œâ”€â”€ loading.tsx
    â””â”€â”€ error.tsx

components/debate/
â”œâ”€â”€ DebateArena.tsx              # ì „ì²´ í† ë¡  ë ˆì´ì•„ì›ƒ (ì„ ë°œëœ 3ì¸ ë°°ì¹˜)
â”œâ”€â”€ PersonaCard.tsx              # í˜ë¥´ì†Œë‚˜ ì¹´ë“œ (ë°œì–¸ ì¤‘ ì• ë‹ˆë©”ì´ì…˜)
â”œâ”€â”€ ChatBubble.tsx               # ë§í’ì„  (Framer Motion íƒ€ì´í•‘ ì• ë‹ˆë©”ì´ì…˜)
â”œâ”€â”€ VotePanel.tsx                # íˆ¬í‘œ ë²„íŠ¼ + í¼ì„¼íŠ¸ ë°”
â””â”€â”€ SummaryPanel.tsx             # í† ë¡  ì¢…ë£Œ í›„ Gemini ìš”ì•½ íŒ¨ë„

hooks/
â””â”€â”€ useDebate.ts                 # SSE ìŠ¤íŠ¸ë¦¬ë° ìˆ˜ì‹  + ìë™ ë‹¤ìŒ í„´ íŠ¸ë¦¬ê±°

lib/
â”œâ”€â”€ prisma.ts                    # Prisma Client ì‹±ê¸€í†¤
â”œâ”€â”€ gemini.ts                    # Gemini ìŠ¤íŠ¸ë¦¬ë°/ë…¼ìŠ¤íŠ¸ë¦¬ë° API í˜¸ì¶œ
â””â”€â”€ personas.ts                  # í˜ë¥´ì†Œë‚˜ 8ì¢… ì •ì˜ + ëœë¤ ì„ ë°œ + í”„ë¡¬í”„íŠ¸ ë¹Œë”

prisma/schema.prisma             # DB ìŠ¤í‚¤ë§ˆ
sql/schema/                      # ìˆ˜ë™ ì‹¤í–‰ìš© SQL (01~04)
docs/sequence-diagram.md         # ì‹œìŠ¤í…œ ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨
```

## API ì—”ë“œí¬ì¸íŠ¸

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/debate/start` | í† ë¡  ìƒì„± (ì£¼ì œ, í„´ ìˆ˜, ëœë¤ 3ì¸ ì„ ë°œ) |
| GET  | `/api/debate/:id` | í† ë¡  + ë©”ì‹œì§€ ì „ì²´ ì¡°íšŒ (personas í¬í•¨) |
| POST | `/api/debate/:id/next` | ë‹¤ìŒ í„´ Gemini ìŠ¤íŠ¸ë¦¬ë° í˜¸ì¶œ |
| POST | `/api/debate/:id/vote` | IP ê¸°ë°˜ íˆ¬í‘œ (ì¤‘ë³µ ë°©ì§€) |
| GET  | `/api/debate/:id/summary` | í˜ë¥´ì†Œë‚˜ë³„ í† ë¡  ìš”ì•½ ìƒì„± |

## DB í…Œì´ë¸”

| í…Œì´ë¸” | ì„¤ëª… |
|--------|------|
| `t_persona_debates` | í† ë¡  (uuid, topic, status, í„´ìˆ˜, **personas**) |
| `t_persona_message` | ë°œì–¸ (debates_uuid, persona, content, turn_number) |
| `t_persona_votes` | íˆ¬í‘œ (debates_uuid, persona, ip) â€” IPë‹¹ 1í‘œ |

> `debates_personas`: ì„ ë°œëœ 3ëª…ì˜ í‚¤ë¥¼ ì‰¼í‘œ êµ¬ë¶„ìœ¼ë¡œ ì €ì¥ (ì˜ˆ: `"A,D,G"`)

## í™˜ê²½ë³€ìˆ˜

```bash
DATABASE_URL="mysql://user:password@host:3306/dbname"
GEMINI_API_KEY="..."
```

## ì‹¤í–‰

```bash
# ê°œë°œ
npm run dev

# í”„ë¡œë•ì…˜
npm run build
npm start          # í¬íŠ¸ 3020

# PM2
pm2 start ecosystem.config.js
pm2 reload persona  # ë¬´ì¤‘ë‹¨ ì¬ì‹œì‘
pm2 logs persona    # ë¡œê·¸ í™•ì¸

# DB ë§ˆì´ê·¸ë ˆì´ì…˜ (ì‹ ê·œ ì„¤ì¹˜ ì‹œ)
# sql/schema/ íŒŒì¼ì„ 01 â†’ 04 ìˆœì„œë¡œ ì‹¤í–‰
```
